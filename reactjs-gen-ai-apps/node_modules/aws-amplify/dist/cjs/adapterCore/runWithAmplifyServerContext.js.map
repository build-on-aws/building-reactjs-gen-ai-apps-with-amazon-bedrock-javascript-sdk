{"version":3,"file":"runWithAmplifyServerContext.js","sources":["../../../src/adapterCore/runWithAmplifyServerContext.ts"],"sourcesContent":["\"use strict\";\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.runWithAmplifyServerContext = void 0;\nconst adapter_core_1 = require(\"@aws-amplify/core/internals/adapter-core\");\n/**\n * The low level function that supports framework specific helpers.\n * It creates an Amplify server context based on the input and runs the operation\n * with injecting the context, and finally returns the result of the operation.\n *\n * @param amplifyConfig The Amplify resource config.\n * @param libraryOptions The Amplify library options.\n * @param operation The operation to run with the server context created from\n *   `amplifyConfig` and `libraryOptions`.\n * @returns The result returned by the `operation`.\n */\nconst runWithAmplifyServerContext = async (amplifyConfig, libraryOptions, operation) => {\n    const contextSpec = (0, adapter_core_1.createAmplifyServerContext)(amplifyConfig, libraryOptions);\n    // run the operation with injecting the context\n    try {\n        const result = await operation(contextSpec);\n        return result;\n    }\n    finally {\n        // ensures destroy the context regardless whether the operation succeeded or failed\n        (0, adapter_core_1.destroyAmplifyServerContext)(contextSpec);\n    }\n};\nexports.runWithAmplifyServerContext = runWithAmplifyServerContext;\n"],"names":[],"mappings":";;AACA;AACA;AACA,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,OAAO,CAAC,2BAA2B,GAAG,KAAK,CAAC,CAAC;AAC7C,MAAM,cAAc,GAAG,OAAO,CAAC,0CAA0C,CAAC,CAAC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,2BAA2B,GAAG,OAAO,aAAa,EAAE,cAAc,EAAE,SAAS,KAAK;AACxF,IAAI,MAAM,WAAW,GAAG,IAAI,cAAc,CAAC,0BAA0B,EAAE,aAAa,EAAE,cAAc,CAAC,CAAC;AACtG;AACA,IAAI,IAAI;AACR,QAAQ,MAAM,MAAM,GAAG,MAAM,SAAS,CAAC,WAAW,CAAC,CAAC;AACpD,QAAQ,OAAO,MAAM,CAAC;AACtB,KAAK;AACL,YAAY;AACZ;AACA,QAAQ,IAAI,cAAc,CAAC,2BAA2B,EAAE,WAAW,CAAC,CAAC;AACrE,KAAK;AACL,CAAC,CAAC;AACF,OAAO,CAAC,2BAA2B,GAAG,2BAA2B;;"}